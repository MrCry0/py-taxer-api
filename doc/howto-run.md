# Запуск
В зависимости от режима работы приложение требует различных входных параметров (они задаются с помощью переменных среды)
Запуск с помощью указания cookies более предпочтителен, так как в приложение не передаются данные пользователя (username/password), однако потребует неких дополнительных действий (см ниже)

Если запуск идет с помощью указания cookies, нужно установить переменные среды:
* **TAXER_COOKIES** - строка с куками (токен там уже закодирован, его отдельно передавать ненужно).Как получить cookies описано ниже   

Если запускаем с помощью указания user/password:
* **TAXER_USER** - имя пользователя для входа в taxer.ua 
* **TAXER_PWD** - пароль

## Как получить cookies
* Открываем браузер, [логинимся](https://taxer.ua/login)
* Открываем браузерный отладчик (обычно F12)
* Переходим во вкладку Console
* В консоли выполняем `document.cookie`
* Копируем эти данные. Это будет наша переменная **TAXER_COOKIES**
* Taxer выдает куки где-то на 1 неделю, т.е. через неделю они заекспайрятся и нужно будет проделать всю процедуру заново
 
## Запуск с помощью cookies

### Используя [docker](https://www.docker.com/)
- требуется установленный сам [docker](https://www.docker.com/) и [docker-compose](https://docs.docker.com/compose/install/)
- скачать файл docker-compose.yml
- создать файл `.user.env` и поместить туда переменную **TAXER_COOKIES** с содержимым. Должно получиться примерно так:
```env
TAXER_COOKIES=_ga=GA1.2.147289...b28852cb2da6033936efb; XSRF-TOKEN=02da4f9ff62e0f7...4e1217a; _gat=1
```
- открыть новую консоль (cmd) и запустить `docker-сompose up pytaxerapi`
В результате в консоли должна появиться строка типа такой
```log
2020-04-20 16:55:59 INFO     werkzeug              * Running on http://0.0.0.0:80/ (Press CTRL+C to quit)
```
- проверить работу: открыть в браузере http://localhost:7080/docs и попробовать прочитать учетную запись (раздел *account*)
- для завершения работы в консоли нужно нажать Ctrl-C
- В случае возникновения ошибок в консоли будут писаться сообщения. По ним в принципе можно понять что происходит

## Запуск с помощью username/password
В этом режиме никакие махинации с cookies не требуются, т.к. приложение с помощью [Selenium](https://www.selenium.dev/) само выполнит логин и получит cookies.
С другой стороны вы передаете в приложение свои username/password  
Решать вам.  
Итак:
- требуется установленный сам [docker](https://www.docker.com/) и [docker-compose](https://docs.docker.com/compose/install/)
- скачать файл docker-compose.yml
- создать файл `.user.env` и поместить туда переменные **TAXER_USER** и **TAXER_PWD** с содержимым. Должно получиться примерно так:
```env
TAXER_USER=username@domain.com
TAXER_PWD=mypassword
```
- открыть новую консоль (cmd) и запустить `docker-сompose up`
В результате в консоли должна появиться строка типа такой
```log
2020-04-20 16:55:59 INFO     werkzeug              * Running on http://0.0.0.0:80/ (Press CTRL+C to quit)
```
- проверить работу: открыть в браузере http://localhost:7080/docs и попробовать прочитать учетную запись (раздел *account*)
- для завершения работы в консоли нужно нажать Ctrl-C
- В случае возникновения ошибок в консоли будут писаться сообщения. По ним в принципе можно понять что происходит

### Вручную (требуется установленный Python 3.7 или выше)
TODO
